<!doctype html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIT</title>
    <link rel="stylesheet" href="../../css/style.css" class="css">
</head>

<body>

<section class="container">
    <h1 class="no_mb">GIT</h1>
    <div class="after-h1">Система контроля версий</div>
    <ul class="menu">
        <li><a href="#base">Общее</a></li>
        <li><a href="#cancel">Отмена операций</a></li>
        <li><a href="#recovery">Как восстановить файл</a></li>
        <li><a href="#ambulance">Скорая помощь, если "беда" уже пришла(осторожно,хардкор !!!)</a></li>
    </ul>
    <div class="back-panel">
        <a href="../../" class="button button--home">На главную</a>
    </div>
</section>

<section class="container" id="base">
    <h1>Общее</h1>
    <hr>
    <h2>Учебник</h2>
    <p><a href="https://githowto.com/ru" target="_blank">Читать всем</a></p>
    <hr>
    <h2>РЕПОЗИТОРИИ</h2>
    <p class="no_mb">Адреса репозиториев:</p>
    <div class="code">git remote -v</div>
    <p class="no_mb">Изменение адреса репозитория:</p>
    <div class="code">git remote set-url &lt;имя_репозитория&gt; &lt;url_репозитория&gt;</div>
    <hr>
    <h2 class="no_mb">ВЕТКИ</h2>
    <p>Основы ветвления и слияния</p>

    <p class="no_mb">Создание ветки:</p>
    <div class="code no_mb">
        <p>git branch &lt;имя_ветки&gt;</p>
        <p>git checkout &lt;имя_ветки&gt;</p>
    </div>
    <p class="no_mb">или кратко с ключом -b</p>
    <div class="code">
        <p>git checkout -b &lt;имя_ветки&gt; </p>
    </div>
    <p class="no_mb">Переключение на ветку:</p>
    <div class="code">
        <p>git checkout &lt;имя_ветки&gt;</p>
    </div>
    <p class="no_mb">Просмотр списка веток:</p>
    <div class="code">
        <p>git branch</p>
    </div>
    <p class="no_mb">Слияние:</p>
    <p class="no_mb">ВАЖНО!!! Перед слиянием надо переключится туда куда надо слить данные</p>
    <div class="code">
        <p>git checkout &lt;имя_ветки_назначения&gt;</p>
        <p>git merge &lt;имя_ветки&gt;</p>
    </div>
    <p class="no_mb">Удаление ветки:</p>
    <div class="code">
        <p>git branch -d &lt;имя_ветки&gt;</p>
    </div>
    <p class="no_mb">Переименование ветки</p>
    <p class="no_mb">Сначала переименовываем локальную ветку, а затем выгружаем изменения на удаленный сервер,
        удаляем старую ветку на сервере.</p>
    <div class="code no_mb">
        <p>git branch -m &lt;старое_название&gt; &lt;новое_название&gt;</p>
        <p>git push &lt;имя_репозитория&gt; :&lt;старое_название&gt; &lt;новое_название&gt;</p>
    </div>
    <p>ВАЖНО!!! Во второй строчке стоит двоеточие перед старым именем ветки — это команда для удаления ветки на
        сервере!!!</p>
    <hr>
    <h2>КОММИТЫ</h2>
    <p class="no_mb">Добавить в</p>
    <div class="code">
        <p>git add &lt;имя|маска&gt; // git add . -Добавит все отслеживаемые файлы</p>
    </div>
    <p class="no_mb">Создать коммит</p>
    <div class="code">
        <p>git commit -m "&lt;текст_комментария&gt;"</p>
    </div>
    <p class="no_mb">Изменение последнего коммита</p>
    <p class="no_mb">ВАЖНО! Коммит не должен быть запушен на удаленный репо (если нет, то ничего не сломается, но гемор
        потом будет)</p>
    <div class="code">
        <p>git --amend -m "&lt;текст_комментария&gt;"</p>
    </div>
    <p class="no_mb">Записать в репозиторий (в основную ветку)</p>
    <div class="code">
        <p>git push</p>
    </div>
    <p class="no_mb">Записать в репозиторий в ветку</p>
    <div class="code">
        <p>git push &lt;имя_репозитория&gt; &lt;имя_ветки&gt; // git push origin dev</p>
    </div>
    <a href="#" class="button button--top"></a>
</section>

<section class="container" id="cancel">
    <h1>Отмена операций</h1>
    <hr>
    <h2>Отмена коммита</h2>
    <p class="no_mb">
        Для отмены
        <strong>последнего коммита</strong>, если изменения ещё
        <strong>не опубликованы на сервер</strong> (не сделан git push) воспользоваться командой:
    </p>
    <div class="code no_mb">git reset --soft HEAD^</div>
    <p class="no_mb">
        При этом изменённый код удалён не будет (будет зелёным цветом в git status). Вы можете подправить код и
        повторить коммит.
    </p>
    <p>
        <strong>Это работает, если вы не опубликовали свои изменения</strong>. Если же вы уже опубликовали изменения, то
        не остается ничего другого, как сделать коммит, который отменяет коммит.
    </p>
    <p class="no_mb">Пример:</p>
    <p class="no_mb">--soft - отменит коммит, но сохранит изменения в файлах</p>
    <p class="no_mb">--hard - отменит коммит и удалит изменения, сделанные коммитом.</p>
    <p>git reset --soft HEAD~2 - отменит 2 последних коммита, сохранив изменения. Будут видны в git
        status.</p>
    <p class="no_mb">Для отмены опубликованного коммита:</p>
    <div class="code no_mb">git revert &lt;хеш код&gt;</div>
    <p>Хеш смотрим в <strong>git log</strong>.</p>
    <hr>
    <h2>Отмена отслеживания</h2>
    <p class="no_mb">Отменить отслеживание файла:</p>
    <div class="code no_mb">git rm --cached &lt;имя файла&gt;</div>
    <p>Важно! Это так же поможет если надо убрать файл из индекса.</p>
    <p class="no_mb">Отменить отслеживание папки:</p>
    <div class="code">git rm --cached -r &lt;имя папки&gt;</div>
    <hr>
    <h2>Отмена изменения в файле</h2>
    <div class="code">git checkout &lt;имя фала&gt;</div>
    <a href="#" class="button button--top"></a>
</section>

<section class="container" id="recovery">
    <h1 class="no_mb">Как восстановить файл</h1>
    <p class="main-mind">Ситуация: вы удалили файл и хотите его восстановить или сделали изменения в файле, которые
        хотите
        отменить. То есть необходимо вернуть файл в то состояние, в котором он находится в Git репозитории.</p>
    <hr>
    <h3>Восстановление удаленного файла или отмена изменений</h3>
    <p class="no_mb">Если вы еще не добавили файл в индекс (<strong>не выполнили git add</strong>), то для
        восстановления файла можно воспользоваться
        командой (вместо myfile необходимо указать файл, который вы восстанавливаете):</p>
    <div class="code">git checkout -- myfile</div>
    <p>Просмотреть список удаленных файлов можно командой: git ls-files --deleted</p>
    <hr>
    <h3>Восстановление удаленного файла, если он уже добавлен в индекс (git add)</h3>
    <p class="no_mb">
        Если вы удалили файл и уже добавили его в индекс, <strong>выполнив git add</strong>, то сначала нужно удалить
        его из индекса, а затем выполнить восстановление, как было показано выше. Для этого выполните команды:
    </p>
    <div class="code">
        <p>git reset -- myfile</p>
        <p>git checkout -- myfile</p>
    </div>
    <p><a href="https://pingvinus.ru/git/1580" target="_blank">источник</a></p>
    <a href="#" class="button button--top"></a>
</section>

<section class="container" id="ambulance">
    <h1 class="no_mb">Скорая помощь, если "беда" уже пришла</h1>
    <p class="main-mind">Документация Git - это хорошо,но чтобы найти решение, тебе заранее надо знать название фишки,
        которая вернёт всё на место.</p>
    <hr>

    <h3>Я накосячил, где у git волшебная машина времени!?!</h3>
    <div class="code">
        <p>git reflog</p>
        <p># вы увидите список всего,</p>
        <p># что сделали в git, во всех ветках!</p>
        <p># у каждого элемента есть индекс HEAD@{индекс}</p>
        <p># найдите тот, перед которым всё сломалось</p>
        <p>git reset HEAD@{index}</p>
        <p># волшебная машина времени</p>
    </div>

    Используйте это чтобы вернуть случайно удалённые штуки, или убрать то чем Вы всё сломали,
    или восстановиться после неудачного слияния, или просто вернуться туда, когда всё работало.
    Я ОЧЕНЬ ЧАСТО использую <strong>reflog</strong>. Снимаю шляпу перед теми, кто предложил добавить это.

    <h3>Я закоммитил и вспомнил, что кое-что забыл!</h3>
    <div class="code">
         <p># сделайте своё изменение</p>
         <p>git add . # или добавьте файлы по отдельности</p>
         <p>git commit --amend --no-edit</p>
         <p># теперь ваш последний коммит содержит это изменение!</p>
         <p># ПРЕДУПРЕЖДЕНИЕ: никогда не меняйте опубликованные коммиты!</p>

         <p></p>
    </div>

    Обычно я это использую когда коммичу, потом запускаю тесты/сканеры... и блин, я не поставил пробел после знака равно.
    Также можно сделать изменения в новом коммите и использовать <strong>rebase -i</strong> чтобы склеить оба коммита вместе,
    но так в миллион раз быстрее.

    <p>Предупреждение: никогда не изменяйте коммиты, отправленные в публичную ветку! Изменяйте только коммиты в вашей
        локальной ветке, иначе Вам не поздоровится.</p>

        <h3>Мне нужно изменить сообщение моего последнего коммита!</h3>
    <div class="code">
        <p>git commit --amend</p>
        <p># открывает редактор для смены сообщения</p>
    </div>

    <h3>Я случайно закоммитил что-то в мастер, хотя это должно быть в новой ветке!</h3>
    <div class="code">
        <p> # создаст новую ветку из текущего состояния мастера</p>
        <p>git branch какое-то-имя-новой-ветки</p>
        <p># удалит последний коммит из мастера</p>
        <p>git reset HEAD~ --hard</p>
        <p>git checkout какое-то-имя-новой-ветки</p>
        <p># ваш коммит теперь живёт в этой ветке :)</p>
    </div>

    NB: это не будет работать, если вы уже отправили коммит в удалённую ветку, и если вы пробовали сделать это
    как-то по-другому, может помочь
    <div class="code">
        <p>git reset HEAD@{количество-коммитов-назад} вместо HEAD~.</p>
    </div>

    <h3>Я случайно закоммитил не в ту ветку!</h3>
    <div class="code">
        <p># отменяет последний коммит, но оставляет изменения доступными</p>
        <p>git reset HEAD~ --soft</p>
        <p>git stash</p>
        <p># переключиться на нужную ветку</p>
        <p>git checkout имя-нужной-ветки</p>
        <p>git stash pop</p>
        <p>git add . # или добавьте отдельные файлы</p>
        <p>git commit -m "ваше сообщение здесь"</p>
        <p># теперь ваши изменения на нужной ветке</p>
    </div>
    Многие люди предлагали использовать <strong>cherry-pick</strong> в такой ситуации, так что выбирайте, то что вам больше нравится!
    <div class="code">
        <p>git checkout имя-нужной-ветки</p>
        <p># скопировать последний коммит из мастера</p>
        <p>git cherry-pick master</p>
        <p># удалить из мастера</p>
        <p>git checkout master</p>
        <p>git reset HEAD~ --hard</p>
    </div>

    <h3>Я пытаюсь открыть diff, но ничего не происходит?!</h3>
    Если вы уверены, что изменили файлы, но diff пуст, возможно вы индексировали изменения (add) и нужно добавить специальный флаг.
    <div class="code">
        <p>git diff --staged</p>
    </div>

    ¯\_(ツ)_/¯ (да, я знаю, что это не баг, а фича, но это неочевидно с первого раза!)

    <h3>Мне нужно отменить коммит, который был 5 коммитов назад!</h3>
    <div class="code">
        <p># найдите коммит, который нужно отменить</p>
        <p>git log</p>
        <p># используйте стрелочки, чтобы прокрутить историю</p>
        <p># сохраните хеш нужного коммита</p>
        <p>git revert [сохранённый хеш]</p>
        <p># git создаст новый коммит, отменяющий выбранный</p>
        <p># отредактируйте сообщений коммита</p>
        <p># или просто сохраните</p>
    </div>

    Вам не нужно откатываться назад и копипастить старый файл в существующий! Если вы закоммитили хрень,
    её можно убрать с revert.

    Также можно отменить только один файл вместо целого коммита! Но конечно, (как всегда у git`а) это
    совершенно другой набор команд...

    <h3>Мне нужно отменить изменения в файле!</h3>
    <div class="code">
        <p># найти хеш коммита, до которого нужно откатиться</p>
        <p>git log</p>
        <p># используйте стрелочки, чтобы прокрутить историю</p>
        <p># сохраните хеш нужного коммита</p>
        <p>git checkout [сохранённый хеш] -- путь/к/файлу</p>
        <p># старая версия файла окажется в вашем индексе</p>
        <p>git commit -m "Ого, теперь не придётся копипастить, чтобы отменить изменения!"</p>
    </div>


    Если серьезно, то где в этой вселенной
    checkout -- лучший способ отменять изменения?

    <h3>К чёрту всё, я сдаюсь. </h3>
    <div class="code">
        <p>cd ..</p>
        <p>sudo rm -r чёртов-репозиторий-git</p>
        <p>git clone https://some.github.url/чёртов-репозиторий-git.git</p>
        <p>cd чёртов-репозиторий-git</p>
    </div>

    Вообще говоря, если ваша ветка настооолько загажена, что нужно вернуться к удалённому состоянию в
    "git-корректном стиле" попробуйте это, но это необратимо!

    <div class="code">
        <p># получить последнее состояние origin</p>
        <p>git fetch origin</p>
        <p>git checkout master</p>
        <p>git reset --hard origin/master</p>
        <p># удалить неиндексированные файлы</p>
        <p>git clean -d --force</p>
        <p># повторить checkout/reset/clean для каждой испорченной ветки</p>
    </div>

    <a href="#" class="button button--top"></a>
</section>

<footer>
    <div class="footer__text"><a href="https://t.me/success_dca" title="Я в телеграм">
        Новиков Павел, 2018-2023
    </a></div>
</footer>

</body>

</html>